Lampa.SettingsApi.addParam({
    component: 'add_plugin',
    param: {
        name: 'Якість в картці фільму', // Назва в списку вибору
        type: 'select',
        values: {
            1: 'Встановити',
            2: 'Видалити',
        },
    },
    field: {
        name: 'Якість в картці фільму', // Назва в налаштуваннях
        description: 'Відображення додаткової інформації про якість фільму в повній картці фільму' // Ваш новий опис
    },
    onChange: function (value, item) { 
        // Посилання на Raw-файл v1
        var pluginUrl = 'https://raw.githubusercontent.com/crowley24/main/main/New_quality_v1.js';
        var pluginName = 'Якість в картці фільму';
        var index = $(item).data('nthChildIndex'); 

        if (value == '1') {
            itemON(pluginUrl, pluginName, '@crowley', pluginName, index); 
        }
        
        if (value == '2') {
            deletePlugin(pluginUrl, index);
        }
    },
    onRender: function (item) { 
        $('.settings-param__name', item).css('color', '#f3d900');
        hideInstall();
        
        var pluginUrl = 'https://raw.githubusercontent.com/crowley24/main/main/New_quality_v1.js';
        var pluginName = 'Якість в картці фільму';
        var myResult = checkPlugin(pluginUrl);
        var pluginsArray = Lampa.Storage.get('plugins') || [];
        
        setTimeout(function () {
            // Додаємо індикатор статусу (кольоровий кружечок)
            $('div[data-name="' + pluginName + '"]').append('<div class="settings-param__status one"></div>');
            var pluginStatus = null;
            
            for (var i = 0; i < pluginsArray.length; i++) {
                if (pluginsArray[i].url === pluginUrl) {
                    pluginStatus = pluginsArray[i].status;
                    break;
                }
            }
            
            var statusElem = $('div[data-name="' + pluginName + '"]').find('.settings-param__status');
            
            if (myResult && pluginStatus !== 0) {
                // Зелений - встановлено та активний
                statusElem.removeClass('active error').css('background', 'linear-gradient(45deg, #11e400, #36a700)');
            } else if (pluginStatus === 0) {
                // Помаранчевий - вимкнено
                statusElem.removeClass('active error').css('background', 'linear-gradient(45deg, #ff8c00, #d96e00)');
            } else {
                // Червоний - не встановлено
                statusElem.removeClass('active error').css('background', 'linear-gradient(45deg, #ff0000, #c40000)');
            }
        }, 100);

        item.on("hover:enter", function (event) {
            var localNthChildIndex = focus_back(event);
            $(this).data('nthChildIndex', localNthChildIndex);
        });
    }
});
